<div class="container">
  <div class="conversation-filter">
    <h1>Messages</h1>
    <div class="dropdown">
      <a class="btn btn-light dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown">
        All Messages(<%= @user_conversations.count %>)
      </a>
      <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
        <a class="dropdown-item" href="#">All Messages(<%= @user_conversations.count %>)</a>
        <a class="dropdown-item" href="#">Another action</a>
        <a class="dropdown-item" href="#">Something else here</a>
      </div>
    </div>
  </div>
  <div class="conversations-box">
    <ul>
      <%  @user_conversations.each do |conversation| %>
        <li>
          <% if conversation.messages.present? %>
            <div class="message-box">
              <div class="message-user-avatar">
                <%= image_tag "https://www.pinestrawmag.com/wp-content/uploads/2017/07/4yrcs2zo.png", class: "avatar" %>
              </div>
              <div class="message-user-name">
                <p>
                  <% if current_user.id == conversation.creator_id %>
                    <%= User.find(conversation.helper_id).first_name%> %>
                  <% else %>
                    <%= User.find(conversation.helper_id).first_name  %>
                  <% end %>
                </p>
                <p><%= conversation.messages.last.created_at.strftime("%d/%m/%Y") %></p>
              </div>
              <div class="message-body">
                <%= link_to conversation.messages.last.body, conversation_path(conversation)%>
              </div>
              <div class="request-state">
                <%= Request.find(conversation.request_id).status %>
              </div>
            </div>
          <% else %>
            <p>Currently there is no conversation present</p>
          <% end %>
        </li>
      <% end %>
    </ul>
  </div>
</div>
